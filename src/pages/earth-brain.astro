---
import IndexLayout from '@/layouts/IndexLayout.astro'
// æˆ‘ä»¬ä¸ç”¨é»˜è®¤çš„ About ç»„ä»¶ï¼Œæ¢æˆåœ°çƒå¤§è„‘çš„ä»‹ç»
import PostList from '@/components/widgets/PostList.astro'
import { themeConfig } from '@/config'
import { getSortedFilteredPosts } from '@/utils/draft'

// è·å–æ‰€æœ‰æ–‡ç« 
---
import IndexLayout from '@/layouts/IndexLayout.astro'
import PostList from '@/components/widgets/PostList.astro'
import { getSortedFilteredPosts } from '@/utils/draft'

const allPosts = await getSortedFilteredPosts()

// 1. å…ˆæŠŠå±äºâ€œåœ°çƒå¤§è„‘â€çš„æ–‡ç« æ‹å‡ºæ¥
const brainPosts = allPosts.filter(post => post.data.category === 'earth-brain')

// 2. åˆ†ç±»ï¼šæŠŠæ‹å‡ºæ¥çš„æ–‡ç« æŒ‰æ ‡ç­¾ï¼ˆtagsï¼‰å¡è¿›ä¸åŒçš„â€œæŠ½å±‰â€
const moviePosts = brainPosts.filter(post => post.data.tags?.includes('ç”µå½±'))
const gamePosts = brainPosts.filter(post => post.data.tags?.includes('æ¸¸æˆ'))
const otherPosts = brainPosts.filter(post => !post.data.tags?.includes('ç”µå½±') && !post.data.tags?.includes('æ¸¸æˆ'))
---

<IndexLayout title="ğŸŒ åœ°çƒå¤§è„‘">
  <section>
    <h1 style="font-size: 2rem; margin-bottom: 2rem;">ğŸŒ åœ°çƒå¤§è„‘</h1>

    {moviePosts.length > 0 && (
      <div class="category-section">
        <h2 style="display: flex; align-items: center; gap: 10px;">
          <img src="/movie-icon.png" style="width: 30px;" /> ç”µå½±è®°å½•
        </h2>
        <PostList posts={moviePosts} />
      </div>
    )}

    {gamePosts.length > 0 && (
      <div class="category-section">
        <h2 style="display: flex; align-items: center; gap: 10px;">
          <img src="/game-icon.png" style="width: 30px;" /> æ¸¸æˆå­˜æ¡£
        </h2>
        <PostList posts={gamePosts} />
      </div>
    )}
  </section>
</IndexLayout>

<style>
  .category-section {
    margin-bottom: 3rem; /* æ¯ä¸€å—åˆ†ç±»ä¹‹é—´ç©ºå¼€å¤§ä¸€ç‚¹ï¼Œæ›´æœ‰å‘¼å¸æ„Ÿ */
    border-top: 1px solid #eee; /* åŠ ä¸€æ¡ç»†ç»†çš„åˆ†å‰²çº¿ */
    padding-top: 1rem;
  }
</style>

// ã€å…³é”®ä¿®æ”¹ã€‘åªç­›é€‰æ ‡é¢˜é‡Œå¸¦æœ‰â€œğŸŒâ€æˆ–è€…ä½ åœ¨æ–‡ç« é‡Œæ‰“è¿‡â€œåœ°çƒå¤§è„‘â€æ ‡ç­¾çš„å†…å®¹
// æˆ–è€…ç®€å•ç‚¹ï¼šç­›é€‰ category ä¸º "earth-brain" çš„æ–‡ç« 
const posts = allPosts.filter(post => 
  post.data.category === 'earth-brain' || post.data.title.includes('ğŸŒ')
)
---

<IndexLayout title="ğŸŒ åœ°çƒå¤§è„‘ | ãƒ¨ãƒ¨ã®ä¸–ç•Œ" description="æ”¾æˆ‘å–œæ¬¢çš„ä¸œè¥¿ï¼šç”µå½±ã€æ¸¸æˆã€ä¹¦">
  <div style="margin-bottom: 2rem;">
    <h1 style="font-size: 2rem; font-weight: bold;">ğŸŒ </h1>
    <p style="opacity: 0.8; margin-top: 0.5rem;">æ‰€æœ‰å–œæ¬¢çš„ä¸œè¥¿ã€‚</p>
  </div>

  <main>
    {posts.length > 0 ? (
      <PostList posts={posts} />
    ) : (
      <p style="padding: 2rem; border: 1px dashed var(--text-primary); text-align: center;">
        å¤§è„‘ç©ºè¡è¡... å¿«å» src/content/posts é‡Œå†™ç¬¬ä¸€ç¯‡ç¬”è®°å§ï¼<br/>
        (è®°å¾—åœ¨æ–‡ç« å¼€å¤´å†™ä¸Š category: earth-brain)
      </p>
    )}
  </main>
</IndexLayout>
